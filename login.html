<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ANIMAL CARE 路 Login</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Tus estilos -->
  <link rel="stylesheet" href="css/styles.css">
</head>

<body class="login-page">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">ANIMAL CARE</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="navMain" class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto gap-2">
          <li class="nav-item"><a class="nav-link" href="index.html">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link active" href="login.html">Login</a></li>
          <li class="nav-item"><a class="nav-link" href="voluntariados.html">Voluntariados</a></li>
          <li class="nav-item"><a class="nav-link" href="usuarios.html">Usuarios</a></li>
        </ul>

        <span class="navbar-text">
          Usuario: <strong id="usuarioActivoLabel">-no login-</strong>
        </span>
        <button id="logoutBtn" class="btn btn-outline-light btn-sm ms-3" type="button">Cerrar sesi贸n</button>
      </div>
    </div>
  </nav>

  <!-- Contenido principal -->
  <main class="container page-wrap">
    <div class="login-wrap">
      <div class="login-box">
        <div class="login-head">INICIAR SESIN</div>

        <div class="login-body">
          <form id="loginForm" novalidate>
            <div class="mb-3">
              <label for="emailInput" class="form-label label-white">CORREO ELECTRNICO</label>
              <input type="email" id="emailInput" class="form-control input-brown"
                     placeholder="INTRODUCE TU CORREO ELECTRNICO" required>
            </div>

            <div class="mb-3">
              <label for="passwordInput" class="form-label label-white">CONTRASEA</label>
              <input type="password" id="passwordInput" class="form-control input-brown"
                     placeholder="INTRODUCE TU CONTRASEA" required>
            </div>

            <button id="loginButton" class="btn btn-blue w-100" type="submit">INICIAR SESIN</button>
          </form>

          <!--  ALERTA DENTRO DE LA CAJA -->
          <div id="alerta" class="alert mt-3 d-none" role="alert"></div>
        </div>

        <div class="login-foot">ANIMAL CARE</div>
      </div>
    </div>
  </main>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- JS embebido: almacenaje + l贸gica del login -->
  <script>
  (function(){
    // ====== "BD" de prueba
    const usuarios = [
      { email: "admin@animalcare.org", password: "admin123",  nombre: "Admin AnimalCare",   rol: "admin" },
      { email: "volu@animalcare.org",  password: "volu12345", nombre: "Voluntaria Daniela", rol: "voluntario" }
    ];
    const LS_KEY = "usuarioActivoEmail";
    const norm = s => (s || "").trim().toLowerCase();

    // ====== Helpers UI
    const $ = s => document.querySelector(s);
    const label = $("#usuarioActivoLabel");
    const alerta = $("#alerta");
    const form = $("#loginForm");
    const emailInput = $("#emailInput");
    const passInput = $("#passwordInput");
    const logoutBtn = $("#logoutBtn");

    function mostrarUsuarioActivo(){
      const email = localStorage.getItem(LS_KEY);
      const u = usuarios.find(x => x.email === email);
      label.textContent = u ? u.nombre : "-no login-";
    }

    function mostrarAlerta(tipo, msg){
      if(!alerta) return;
      alerta.className = "alert mt-3 alert-" + tipo;
      alerta.textContent = msg;
      alerta.classList.remove("d-none");
      alerta.scrollIntoView({behavior:"smooth", block:"nearest"});
    }

    function loguearUsuario(email, password){
      const u = usuarios.find(x => x.email === norm(email));
      if(!u) return { ok:false, error:"Usuario no encontrado" };
      if(u.password !== password) return { ok:false, error:"Contrase帽a incorrecta" };
      localStorage.setItem(LS_KEY, u.email);
      return { ok:true, user:u };
    }

    function cerrarSesion(){
      localStorage.removeItem(LS_KEY);
      mostrarUsuarioActivo();
      mostrarAlerta("info", "Sesi贸n cerrada.");
    }

    // ====== Eventos
    document.addEventListener("DOMContentLoaded", function(){
      mostrarUsuarioActivo();

      if (form) {
        form.addEventListener("submit", function(e){
          e.preventDefault(); // evita recarga
          const email = emailInput.value;
          const pass = passInput.value;
          const res = loguearUsuario(email, pass);
          if(res.ok){
            mostrarUsuarioActivo();
            mostrarAlerta("success", "Bienvenida, " + res.user.nombre + ". Inicio de sesi贸n correcto.");
            // window.location.href = "index.html"; // si quieres redirigir
          }else{
            mostrarAlerta("danger", res.error || "No se pudo iniciar sesi贸n.");
          }
        });
      }

      if (logoutBtn) {
        logoutBtn.addEventListener("click", cerrarSesion);
      }
    });
  })();
  </script>
</body>
</html>

